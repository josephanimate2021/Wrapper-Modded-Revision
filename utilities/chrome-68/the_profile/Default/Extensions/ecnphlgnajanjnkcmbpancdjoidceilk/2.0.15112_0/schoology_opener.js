chrome.webRequest.onHeadersReceived.addListener((function(e){if(/(kamihq\.com|kamipdf\.com)/.test(e.initiator))return;const s=e.responseHeaders.find((e=>"location"==e.name));let t=new URL(s.value),a="Kami Assignment",n=t.searchParams.get("content-disposition");if(n){const e=/filename=".+k_sch_[^_]+_(.+)"/;let s=n.match(e)[1];s&&(a=s)}return n.includes("k_sch_")?(chrome.tabs.get(e.tabId,(s=>{chrome.tabs.sendMessage(e.tabId,{redirectUrl:s.url,filename:a})})),chrome.tabs.sendMessage(e.tabId,{redirectUrl:e.initiator}),chrome.tabs.sendMessage(e.tabId,{file_link:e.url,filename:a}),{cancel:!0}):void 0}),{urls:["https://app.schoology.com/attachment/*/source/*"]},["blocking","responseHeaders"]);